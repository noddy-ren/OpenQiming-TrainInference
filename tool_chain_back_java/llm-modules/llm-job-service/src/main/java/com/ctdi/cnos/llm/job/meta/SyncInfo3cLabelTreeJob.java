package com.ctdi.cnos.llm.job.meta;

import cn.hutool.core.collection.CollectionUtil;
import com.alibaba.fastjson.JSON;
import com.ctdi.cnos.llm.beans.meta.projectSpace.Label3cTreeDTO;
import com.ctdi.cnos.llm.beans.meta.projectSpace.Type3cDTO;
import com.ctdi.cnos.llm.beans.train.IntentRecognition.Info3cLabelTree;
import com.ctdi.cnos.llm.beans.train.IntentRecognition.Info3cTreeParam;
import com.ctdi.cnos.llm.beans.train.IntentRecognition.Info3cTreeResp;
import com.ctdi.cnos.llm.feign.metadata.DataSetServiceClientFeign;
import com.ctdi.cnos.llm.feign.metadata.Label3cTreeServiceClientFeign;
import com.ctdi.cnos.llm.feign.metadata.Type3cServiceClientFeign;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Component;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.stream.Collectors;

/**
 * <b>请输入名称</b>
 * <p>
 * 描述<br/>
 * 作用：；<br/>
 * 限制：；<br/>
 * </p>
 *
 * @author wan.liang(79274)
 * @date 2025/6/10 18:42
 */
@Component("syncInfo3cLabelTreeJob")
@RequiredArgsConstructor
@Slf4j
public class SyncInfo3cLabelTreeJob {


    private final DataSetServiceClientFeign  dataSetServiceClientFeign;

    private final Label3cTreeServiceClientFeign label3cTreeServiceClientFeign;

    private final Type3cServiceClientFeign type3cServiceClient;
    private final String msg = "{\"msg\":\"操作成功\",\"code\":200,\"data\":[{\"type\":\"C3\",\"typeName\":\"流程领域\",\"labelTrees\":[{\"id\":98,\"code\":\"guihua\",\"name\":\"规划\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"非必填，未来可以开发后台AI自动识别，减少人工工作量\",\"children\":null},{\"id\":99,\"code\":\"jianshe\",\"name\":\"建设\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"非必填，未来可以开发后台AI自动识别，减少人工工作量。产品研发也属于“建设”类\",\"children\":null},{\"id\":100,\"code\":\"weihu\",\"name\":\"维护\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"非必填，未来可以开发后台AI自动识别，减少人工工作量\",\"children\":null},{\"id\":101,\"code\":\"youhua\",\"name\":\"优化\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"非必填，未来可以开发后台AI自动识别，减少人工工作量\",\"children\":null},{\"id\":102,\"code\":\"yunying\",\"name\":\"运营\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"非必填，未来可以开发后台AI自动识别，减少人工工作量\",\"children\":null}]},{\"type\":\"C1.3\",\"typeName\":\"公开范围\",\"labelTrees\":[{\"id\":35,\"code\":\"allNet\",\"name\":\"全网通用\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"系统默认集团内全网通用\",\"children\":null},{\"id\":36,\"code\":\"province\",\"name\":\"省内专用\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"基于信息安全和跨省的管理、机制、标准不统一带来大模型判断出现混淆问题，省内知识不适合在大模型通用训练的材料，需要标明仅用于省内使用\",\"children\":null}]},{\"type\":\"C1.2\",\"typeName\":\"应用场景\",\"labelTrees\":[{\"id\":19,\"code\":\"xczc\",\"name\":\"现场支撑\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":20,\"code\":\"xczw\",\"name\":\"现场综维\",\"level\":\"2\",\"parentId\":19,\"remark\":\"根据大模型使用场景填写\",\"children\":null},{\"id\":21,\"code\":\"xczhw\",\"name\":\"现场装维\",\"level\":\"2\",\"parentId\":19,\"remark\":\"根据大模型使用场景填写\",\"children\":null}]},{\"id\":22,\"code\":\"wlyh\",\"name\":\"网络优化\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":23,\"code\":\"wxwy\",\"name\":\"无线网优\",\"level\":\"2\",\"parentId\":22,\"remark\":\"根据大模型使用场景填写\",\"children\":null},{\"id\":24,\"code\":\"ycfx\",\"name\":\"预测分析\",\"level\":\"2\",\"parentId\":22,\"remark\":\"根据大模型使用场景填写\",\"children\":null}]},{\"id\":25,\"code\":\"whjk\",\"name\":\"监控维护\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":26,\"code\":\"gzgl\",\"name\":\"故障管理\",\"level\":\"2\",\"parentId\":25,\"remark\":\"根据大模型使用场景填写\",\"children\":null},{\"id\":27,\"code\":\"zljh\",\"name\":\"指令稽核\",\"level\":\"2\",\"parentId\":25,\"remark\":\"根据大模型使用场景填写\",\"children\":null},{\"id\":28,\"code\":\"gdzj\",\"name\":\"工单质检\",\"level\":\"2\",\"parentId\":25,\"remark\":\"根据大模型使用场景填写\",\"children\":null},{\"id\":368,\"code\":\"yhgk\",\"name\":\"隐患管控\",\"level\":\"2\",\"parentId\":25,\"remark\":\"数字员工新增场景\",\"children\":null}]},{\"id\":30,\"code\":\"yyjc\",\"name\":\"运营决策\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":31,\"code\":\"tsgz\",\"name\":\"态势感知\",\"level\":\"2\",\"parentId\":30,\"remark\":\"根据大模型使用场景填写\",\"children\":null},{\"id\":32,\"code\":\"yjbz\",\"name\":\"应急保障\",\"level\":\"2\",\"parentId\":30,\"remark\":\"根据大模型使用场景填写\",\"children\":null},{\"id\":132,\"code\":\"gzzd\",\"name\":\"规章制度\",\"level\":\"2\",\"parentId\":30,\"remark\":null,\"children\":null},{\"id\":358,\"code\":\"yyfx\",\"name\":\"运营分析\",\"level\":\"2\",\"parentId\":30,\"remark\":null,\"children\":null}]},{\"id\":33,\"code\":\"khfw\",\"name\":\"客户服务\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":34,\"code\":\"tscl\",\"name\":\"投诉处理\",\"level\":\"2\",\"parentId\":33,\"remark\":\"根据大模型使用场景填写\",\"children\":null},{\"id\":360,\"code\":\"ywkt\",\"name\":\"业务开通\",\"level\":\"2\",\"parentId\":33,\"remark\":\"业务开通\",\"children\":null},{\"id\":362,\"code\":\"yxzc\",\"name\":\"营销支持\",\"level\":\"2\",\"parentId\":33,\"remark\":null,\"children\":null}]},{\"id\":345,\"code\":\"ghjs\",\"name\":\"规划建设\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":346,\"code\":\"ywgh\",\"name\":\"云网规划\",\"level\":\"2\",\"parentId\":345,\"remark\":null,\"children\":null},{\"id\":347,\"code\":\"ywjs\",\"name\":\"云网建设\",\"level\":\"2\",\"parentId\":345,\"remark\":null,\"children\":null}]}]},{\"type\":\"C1.1\",\"typeName\":\"来源\",\"labelTrees\":[{\"id\":3,\"code\":\"partner\",\"name\":\"伙伴\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":6,\"code\":\"datang\",\"name\":\"大唐\",\"level\":\"2\",\"parentId\":3,\"remark\":\"云网运营过程中合作厂家或者合作单位\",\"children\":null},{\"id\":7,\"code\":\"ericsson\",\"name\":\"爱立信\",\"level\":\"2\",\"parentId\":3,\"remark\":\"云网运营过程中合作厂家或者合作单位\",\"children\":null},{\"id\":8,\"code\":\"nokia\",\"name\":\"诺基亚\",\"level\":\"2\",\"parentId\":3,\"remark\":\"云网运营过程中合作厂家或者合作单位\",\"children\":null},{\"id\":9,\"code\":\"fenghuo\",\"name\":\"烽火\",\"level\":\"2\",\"parentId\":3,\"remark\":\"云网运营过程中合作厂家或者合作单位\",\"children\":null},{\"id\":10,\"code\":\"other\",\"name\":\"其他\",\"level\":\"2\",\"parentId\":3,\"remark\":\"手工填写三方/伙伴名称\",\"children\":null},{\"id\":366,\"code\":\"sike\",\"name\":\"思科\",\"level\":\"2\",\"parentId\":3,\"remark\":null,\"children\":null},{\"id\":367,\"code\":\"xinhua3\",\"name\":\"新华三\",\"level\":\"2\",\"parentId\":3,\"remark\":null,\"children\":null}]},{\"id\":11,\"code\":\"qita\",\"name\":\"其他\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"手工填写三方/伙伴名称\",\"children\":[{\"id\":7,\"code\":\"wanfang\",\"name\":\"万方\",\"level\":\"2\",\"parentId\":11,\"remark\":null,\"children\":null},{\"id\":12,\"code\":\"e-library\",\"name\":\"电子图书馆\",\"level\":\"2\",\"parentId\":11,\"remark\":\"如法律法规、专业书籍、专业资料、期刊、论文等期刊-《数字技术与应用》、《通讯世界》、《现代传输》、《软件》《光通信技术》、《光通信研究》等\",\"children\":null},{\"id\":14,\"code\":\"standardOrg\",\"name\":\"标准组织\\r\\n\",\"level\":\"2\",\"parentId\":11,\"remark\":\"信通院、中国通信标准化协会、3GPP、TMF等,要求中文形式的内容\",\"children\":null},{\"id\":15,\"code\":\"otherWebSite\",\"name\":\"其他组织机构或网站\",\"level\":\"2\",\"parentId\":11,\"remark\":\"百科、wiki等\",\"children\":null},{\"id\":354,\"code\":\"weipu\",\"name\":\"维普\",\"level\":\"2\",\"parentId\":11,\"remark\":\"来自维普数据库、论文、期刊等、专业电子出版物、专业考试等\",\"children\":null},{\"id\":355,\"code\":\"meeting\",\"name\":\"会议&峰会&论坛\",\"level\":\"2\",\"parentId\":11,\"remark\":\"各类行业研讨会、峰会、学术学会发言或发布的知识\",\"children\":null},{\"id\":356,\"code\":\"otherCompany\",\"name\":\"其他外部企业\",\"level\":\"2\",\"parentId\":11,\"remark\":\"非合作伙伴的商业企业\",\"children\":null}]},{\"id\":111,\"code\":\"author\",\"name\":\"作者\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":112,\"code\":\"jtnzscjz\",\"name\":\"集团内知识创建者\",\"level\":\"2\",\"parentId\":111,\"remark\":\"\",\"children\":null},{\"id\":113,\"code\":\"dsfzscjz\",\"name\":\"第三方的对接人\",\"level\":\"2\",\"parentId\":111,\"remark\":\"\",\"children\":null},{\"id\":114,\"code\":\"zsdzz\",\"name\":\"知识的作者\",\"level\":\"2\",\"parentId\":111,\"remark\":\"\",\"children\":null}]},{\"id\":352,\"code\":\"government\",\"name\":\"政府部门\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":null},{\"id\":353,\"code\":\"telecom\",\"name\":\"电信内部\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"电信内部\",\"children\":null},{\"id\":363,\"code\":\"xckfdmx\",\"name\":\"星辰客服大模型\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":null}]},{\"type\":\"document_type\",\"typeName\":\"文档类型\",\"labelTrees\":[{\"id\":389,\"code\":\"standard\",\"name\":\"学术标准\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":394,\"code\":\"dt_gjbz\",\"name\":\"国际标准\",\"level\":\"2\",\"parentId\":389,\"remark\":\"由3GPP、ITU-T、ETSI、IETF、ISO、IEEE、EIA、ANSI、IEC、OIF、TMF、GSMA等标准组织或权威机构制定和发布的标准等\",\"children\":null},{\"id\":395,\"code\":\"dt_guojiabz\",\"name\":\"国家标准\",\"level\":\"2\",\"parentId\":389,\"remark\":\"国家标准化管理委员会制定并发布的，旨在规范电信行业的技术要求、管理流程和服务标准。国家标准编号通常以“GB”开头\",\"children\":null},{\"id\":396,\"code\":\"dt_hybz\",\"name\":\"行业标准\",\"level\":\"2\",\"parentId\":389,\"remark\":\"由中国通信标准化协会CCSA、信通院、未来移动通信论坛、数据中心联盟（DCA）、\",\"children\":null},{\"id\":397,\"code\":\"dt_qybz\",\"name\":\"企业标准\",\"level\":\"2\",\"parentId\":389,\"remark\":\"中国电信集团内部制定的标准，用于指导企业内部的产品开发、生产和质量控制\",\"children\":null}]},{\"id\":398,\"code\":\"dt_flfg\",\"name\":\"法律法规\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":399,\"code\":\"dt_row\",\"name\":\"法律\",\"level\":\"2\",\"parentId\":398,\"remark\":\"法律：网络安全法、全国人民代表大会常务委员会关于维护互联网安全的决定 、关于加强网络信息保护的决定、国网络安全法等 \",\"children\":null},{\"id\":400,\"code\":\"dt_rule\",\"name\":\"法规\",\"level\":\"2\",\"parentId\":398,\"remark\":\"法规：国家电信条例、国无线电管理条例、互联网信息服务管理办法等\",\"children\":null},{\"id\":401,\"code\":\"dt_zcwj\",\"name\":\"政策文件\",\"level\":\"2\",\"parentId\":398,\"remark\":\"法规：国家电信条例、国无线电管理条例、互联网信息服务管理办法等\",\"children\":null}]},{\"id\":402,\"code\":\"hybghbps\",\"name\":\"行业报告和白皮书\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":403,\"code\":\"dt_yjbg\",\"name\":\"研究报告\",\"level\":\"2\",\"parentId\":402,\"remark\":\"内部：电信集团、研究院、专业公司、省级单位发布的通信、信息、数据、计算、云、安全相关的研究报告、白皮书\",\"children\":null},{\"id\":404,\"code\":\"dt_zxbg\",\"name\":\"咨询报告\",\"level\":\"2\",\"parentId\":402,\"remark\":\"内部：电信集团、研究院、专业公司、省级单位发布的通信、信息、数据、计算、云、安全相关的研究报告、白皮书\",\"children\":null},{\"id\":405,\"code\":\"dt_bps\",\"name\":\"白皮书\",\"level\":\"2\",\"parentId\":402,\"remark\":\"内部：电信集团、研究院、专业公司、省级单位发布的通信、信息、数据、计算、云、安全相关的研究报告、白皮书\",\"children\":null}]},{\"id\":406,\"code\":\"lwqk\",\"name\":\"论文期刊\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":407,\"code\":\"dt_zylw\",\"name\":\"专业论文\",\"level\":\"2\",\"parentId\":406,\"remark\":\"中文，专业论文\",\"children\":null},{\"id\":408,\"code\":\"dt_zyqk\",\"name\":\"专业期刊\",\"level\":\"2\",\"parentId\":406,\"remark\":\"中文，专业期刊\",\"children\":null}]},{\"id\":409,\"code\":\"dzjc\",\"name\":\"电子教材\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":410,\"code\":\"dt_jcll\",\"name\":\"基础理论\",\"level\":\"2\",\"parentId\":409,\"remark\":\"中文，企业内外部专业出版物\",\"children\":null},{\"id\":411,\"code\":\"dt_zyjc\",\"name\":\"专业教材\",\"level\":\"2\",\"parentId\":409,\"remark\":\"中文，企业内外部专业出版物\",\"children\":null}]},{\"id\":412,\"code\":\"zyst\",\"name\":\"专业试题\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":413,\"code\":\"dt_kssm\",\"name\":\"考试说明\",\"level\":\"2\",\"parentId\":412,\"remark\":\"通信和计算机考试说明\",\"children\":null},{\"id\":414,\"code\":\"dt_zyst\",\"name\":\"专业试题（含答案）\",\"level\":\"2\",\"parentId\":412,\"remark\":\"通信和计算机考试试题（含答案），无答案不需要上传\",\"children\":null}]},{\"id\":415,\"code\":\"zhl\",\"name\":\"专利\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":416,\"code\":\"dt_zyzl\",\"name\":\"专业专利\",\"level\":\"2\",\"parentId\":415,\"remark\":\"特指国家专利局信息通信相关发明专利，不含实用新型等\",\"children\":null}]},{\"id\":417,\"code\":\"specification\",\"name\":\"规范\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":418,\"code\":\"dt_jsgf\",\"name\":\"技术规范\",\"level\":\"2\",\"parentId\":417,\"remark\":\"在运营过程中遵循的一系列技术标准和操作规程。这些规范涵盖了网络技术、网络建设、设备维护、业务提供、服务质量等多个方面，以确保网络的稳定运行、业务的可靠提供以及用户体验的优化。\",\"children\":null},{\"id\":419,\"code\":\"dt_whgf\",\"name\":\"维护规范\",\"level\":\"2\",\"parentId\":417,\"remark\":\"为了确保网络的正常运行、安全和效率，对网络进行维护时必须遵循的一系列标准和程序。\",\"children\":null},{\"id\":420,\"code\":\"dt_pzgf\",\"name\":\"配置规范\",\"level\":\"2\",\"parentId\":417,\"remark\":\"配置网络设备和服务时必须遵循的一系列标准和指南。\",\"children\":null},{\"id\":421,\"code\":\"dt_clgf\",\"name\":\"处理规范\",\"level\":\"2\",\"parentId\":417,\"remark\":\"为了确保网络的高效、稳定运行，需要遵循的一系列标准操作流程\",\"children\":null},{\"id\":422,\"code\":\"dt_ghgf\",\"name\":\"规划文档\",\"level\":\"2\",\"parentId\":417,\"remark\":\"网络、云、IT等的规划指导意见和标准\",\"children\":null},{\"id\":423,\"code\":\"dt_ywgf\",\"name\":\"业务规范\",\"level\":\"2\",\"parentId\":417,\"remark\":\"为保障服务质量、提高工作效率、确保网络稳定运行而制定的一系列标准和操作指南\",\"children\":null},{\"id\":424,\"code\":\"dt_gzyq\",\"name\":\"工作要求\",\"level\":\"2\",\"parentId\":417,\"remark\":\"一系列为电信运维人员提供的标准和要求\",\"children\":null},{\"id\":425,\"code\":\"dt_gzzy\",\"name\":\"工作指引\",\"level\":\"2\",\"parentId\":417,\"remark\":\"一系列为电信运维人员提供的操作指南和建议\",\"children\":null},{\"id\":426,\"code\":\"dt_glbf\",\"name\":\"管理办法\",\"level\":\"2\",\"parentId\":417,\"remark\":\"一系列为电信网络的高效、稳定运行，同时保障服务质量、网络安全和合规性的管理标准\",\"children\":null},{\"id\":427,\"code\":\"dt_ssxz\",\"name\":\"实施细则\",\"level\":\"2\",\"parentId\":417,\"remark\":\"对工作要求、指引、管理办法的具体化和操作化\",\"children\":null},{\"id\":428,\"code\":\"dt_lcgf\",\"name\":\"流程规范\",\"level\":\"2\",\"parentId\":417,\"remark\":\"一系列有序的步骤，这些步骤按照一定的顺序和规则进行，以完成特定的任务或实现特定的目标\",\"children\":null},{\"id\":429,\"code\":\"dt_fwbz\",\"name\":\"服务标准\",\"level\":\"2\",\"parentId\":417,\"remark\":\"确保满足客户需求而制定的一套具体要求和标准，通常涉及网络性能、故障响应、客户服务等方面。\",\"children\":null},{\"id\":430,\"code\":\"dt_qita\",\"name\":\"其他\",\"level\":\"2\",\"parentId\":417,\"remark\":\"非以上规范\",\"children\":null}]},{\"id\":431,\"code\":\"dt_gfgzzd\",\"name\":\"规章制度\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":432,\"code\":\"dt_jsl\",\"name\":\"技术类\",\"level\":\"2\",\"parentId\":431,\"remark\":\"集团/省级/地市发布的各类云网运营相关的规章制度\",\"children\":null},{\"id\":434,\"code\":\"dt_gll\",\"name\":\"管理类\",\"level\":\"2\",\"parentId\":431,\"remark\":\"集团/省级/地市发布的各类云网运营相关的规章制度\",\"children\":null},{\"id\":435,\"code\":\"dt_jyl\",\"name\":\"经营类\",\"level\":\"2\",\"parentId\":431,\"remark\":\"集团/省级/地市发布的各类云网运营相关的规章制度\",\"children\":null},{\"id\":436,\"code\":\"dt_whl\",\"name\":\"维护类\",\"level\":\"2\",\"parentId\":431,\"remark\":\"集团/省级/地市发布的各类云网运营相关的规章制度\",\"children\":null},{\"id\":437,\"code\":\"dt_gzzd_qita\",\"name\":\"其他\",\"level\":\"2\",\"parentId\":431,\"remark\":\"集团/省级/地市发布的各类云网运营相关的规章制度\",\"children\":null}]},{\"id\":438,\"code\":\"brochure\",\"name\":\"手册\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":439,\"code\":\"dt_cszdsc\",\"name\":\"厂商指导手册\",\"level\":\"2\",\"parentId\":438,\"remark\":\"厂家提供的软件/硬件产品使用指导书、快速指南、用户手册、安装指南、维护指南、故障处理指导等\",\"children\":null},{\"id\":440,\"code\":\"dt_cscpsm\",\"name\":\"厂商产品说明\",\"level\":\"2\",\"parentId\":438,\"remark\":\"产品文档、解决方案介绍、特性文档\",\"children\":null},{\"id\":441,\"code\":\"dt_ywsc\",\"name\":\"业务手册\",\"level\":\"2\",\"parentId\":438,\"remark\":\"公司内各类个人、家庭、政企信息服务产品介绍、使用说明\",\"children\":null},{\"id\":442,\"code\":\"dt_zdsc\",\"name\":\"终端手册\",\"level\":\"2\",\"parentId\":438,\"remark\":\"公司内各类个人、家庭、政企终端产品介绍、、使用说明\",\"children\":null},{\"id\":443,\"code\":\"dt_scqt\",\"name\":\"其他\",\"level\":\"2\",\"parentId\":438,\"remark\":\"非以上分类的手册\",\"children\":null}]},{\"id\":444,\"code\":\"programme\",\"name\":\"方案\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":445,\"code\":\"dt_gzcl\",\"name\":\"故障处理\",\"level\":\"2\",\"parentId\":444,\"remark\":\"公司内，云网运营活动中相关的方案，如建设、优化、运维、运营中产生的方案。\",\"children\":null},{\"id\":446,\"code\":\"dt_yjya\",\"name\":\"应急预案\",\"level\":\"2\",\"parentId\":444,\"remark\":\"公司内，云网运营活动中相关的方案，如建设、优化、运维、运营中产生的方案。\",\"children\":null},{\"id\":447,\"code\":\"dt_yccz\",\"name\":\"异常处置\",\"level\":\"2\",\"parentId\":444,\"remark\":\"公司内，云网运营活动中相关的方案，如建设、优化、运维、运营中产生的方案。\",\"children\":null},{\"id\":448,\"code\":\"dt_gjfa\",\"name\":\"割接方案\",\"level\":\"2\",\"parentId\":444,\"remark\":\"公司内，云网运营活动中相关的方案，如建设、优化、运维、运营中产生的方案。\",\"children\":null},{\"id\":449,\"code\":\"dt_xjfa\",\"name\":\"巡检方案\",\"level\":\"2\",\"parentId\":444,\"remark\":\"公司内，云网运营活动中相关的方案，如建设、优化、运维、运营中产生的方案。\",\"children\":null},{\"id\":450,\"code\":\"dt_csfa\",\"name\":\"测试方案\",\"level\":\"2\",\"parentId\":444,\"remark\":\"公司内，云网运营活动中相关的方案，如建设、优化、运维、运营中产生的方案。\",\"children\":null},{\"id\":451,\"code\":\"dt_jjfa\",\"name\":\"解决方案\",\"level\":\"2\",\"parentId\":444,\"remark\":\"公司内，云网运营活动中相关的方案，如建设、优化、运维、运营中产生的方案。\",\"children\":null},{\"id\":452,\"code\":\"dt_faqt\",\"name\":\"其他\",\"level\":\"2\",\"parentId\":444,\"remark\":\"公司内，云网运营活动中相关的方案，如建设、优化、运维、运营中产生的方案。\",\"children\":null}]},{\"id\":453,\"code\":\"case\",\"name\":\"案例 \",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":454,\"code\":\"dt_ghal\",\"name\":\"规划案例\",\"level\":\"2\",\"parentId\":453,\"remark\":\"网络和IT规划过程中遇到的问题\",\"children\":null},{\"id\":455,\"code\":\"dt_azal\",\"name\":\"安装案例\",\"level\":\"2\",\"parentId\":453,\"remark\":\"软硬件安装或组件安装等过程中遇到的问题 \",\"children\":null},{\"id\":456,\"code\":\"dt_whal\",\"name\":\"维护案例\",\"level\":\"2\",\"parentId\":453,\"remark\":\"软硬件在运行过程中问题，如：启动问题、升级问题、运行问题、性能问题、规格问题等。\",\"children\":null},{\"id\":457,\"code\":\"dt_yhal\",\"name\":\"优化案例\",\"level\":\"2\",\"parentId\":453,\"remark\":\"网络及设备、产品性能提升遇到的问题，如：无线优化、传输优化、核心网优化、IT优化等\",\"children\":null},{\"id\":458,\"code\":\"dt_yxal\",\"name\":\"营销案例\",\"level\":\"2\",\"parentId\":453,\"remark\":\"在销售和营销过程中遇到的问题，如：随销案例等\",\"children\":null},{\"id\":459,\"code\":\"dt_zqal\",\"name\":\"政企案例\",\"level\":\"2\",\"parentId\":453,\"remark\":\"政企客户最佳实践案例\",\"children\":null}]},{\"id\":460,\"code\":\"training_material\",\"name\":\"培训资料\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":[{\"id\":461,\"code\":\"dt_js\",\"name\":\"技术\",\"level\":\"2\",\"parentId\":460,\"remark\":\"运营商接入网（含无线和有线）、传输、核心网、云、数通、安全等技术类培训资料\",\"children\":null},{\"id\":462,\"code\":\"dt_cp\",\"name\":\"产品\",\"level\":\"2\",\"parentId\":460,\"remark\":\"设备、终端等培训资料\",\"children\":null},{\"id\":463,\"code\":\"dt_yw\",\"name\":\"业务\",\"level\":\"2\",\"parentId\":460,\"remark\":\"运营商业务培训，如：语音、数据、增值、多媒体、物联网、云等业务培训资料\",\"children\":null},{\"id\":464,\"code\":\"dt_khfw\",\"name\":\"客户服务\",\"level\":\"2\",\"parentId\":460,\"remark\":\"面向C端客户，政企等客户的客户服务培训资料\",\"children\":null},{\"id\":465,\"code\":\"dt_zlqt\",\"name\":\"其他\",\"level\":\"2\",\"parentId\":460,\"remark\":\"其他有价值的培训资料\",\"children\":null}]},{\"id\":466,\"code\":\"design\",\"name\":\"设计类\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"设计院的设计文档\",\"children\":null},{\"id\":467,\"code\":\"dt_other\",\"name\":\"其他\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"不能归于其他类的\",\"children\":null},{\"id\":468,\"code\":\"Q&A\",\"name\":\"问答对\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"\",\"children\":null}]},{\"type\":\"C2\",\"typeName\":\"专业领域\",\"labelTrees\":[{\"id\":37,\"code\":\"jrw\",\"name\":\"接入网\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":38,\"code\":\"wxjr\",\"name\":\"无线接入\",\"level\":\"2\",\"parentId\":37,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":39,\"code\":\"gjr\",\"name\":\"光接入\",\"level\":\"2\",\"parentId\":37,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":40,\"code\":\"zhw\",\"name\":\"装维\",\"level\":\"2\",\"parentId\":37,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":41,\"code\":\"zw\",\"name\":\"综维\",\"level\":\"2\",\"parentId\":37,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":344,\"code\":\"5gconstructionsharing\",\"name\":\"5G共建共享\",\"level\":\"2\",\"parentId\":37,\"remark\":null,\"children\":null},{\"id\":364,\"code\":\"wxtx\",\"name\":\"无线通信\",\"level\":\"2\",\"parentId\":37,\"remark\":\"无线通信\",\"children\":null}]},{\"id\":42,\"code\":\"coreNet\",\"name\":\"核心网\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":43,\"code\":\"5GCoreNet\",\"name\":\"5G数据核心网\",\"level\":\"2\",\"parentId\":42,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":44,\"code\":\"4GCoreNet\",\"name\":\"4G数据核心网\",\"level\":\"2\",\"parentId\":42,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":45,\"code\":\"NBIoT\",\"name\":\"NBIoT物联网\",\"level\":\"2\",\"parentId\":42,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":46,\"code\":\"point\",\"name\":\"骨干固定语音核心网\",\"level\":\"2\",\"parentId\":42,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":47,\"code\":\"proCoreNet\",\"name\":\"省固定语音核心网\",\"level\":\"2\",\"parentId\":42,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":48,\"code\":\"moveMedia\",\"name\":\"骨干移动多媒体语音核心网\",\"level\":\"2\",\"parentId\":42,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":49,\"code\":\"voilte\",\"name\":\"Volte\",\"level\":\"2\",\"parentId\":42,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":50,\"code\":\"IMS\",\"name\":\"省移动多媒体语音核心网（IMS）\",\"level\":\"2\",\"parentId\":42,\"remark\":\"按照知识的专业领域填写\",\"children\":null}]},{\"id\":51,\"code\":\"business\",\"name\":\"业务平台\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":52,\"code\":\"CDN\",\"name\":\"CDN\",\"level\":\"2\",\"parentId\":51,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":103,\"code\":\"ability\",\"name\":\"能力类\",\"level\":\"2\",\"parentId\":51,\"remark\":null,\"children\":null},{\"id\":104,\"code\":\"business_management\",\"name\":\"业务管理类\",\"level\":\"2\",\"parentId\":51,\"remark\":null,\"children\":null},{\"id\":105,\"code\":\"big_data_AI\",\"name\":\"大数据AI类\",\"level\":\"2\",\"parentId\":51,\"remark\":null,\"children\":null}]},{\"id\":53,\"code\":\"IPNet\",\"name\":\"IP网\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":54,\"code\":\"IPgg\",\"name\":\"IP骨干\",\"level\":\"2\",\"parentId\":53,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":55,\"code\":\"IPjyw\",\"name\":\"IP城域网/IP新型城域网\",\"level\":\"2\",\"parentId\":53,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":56,\"code\":\"IPRANSTN\",\"name\":\"IPRAN/STN\",\"level\":\"2\",\"parentId\":53,\"remark\":\"按照知识的专业领域填写\",\"children\":null}]},{\"id\":57,\"code\":\"transferNet\",\"name\":\"传输网\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":58,\"code\":\"OTN\",\"name\":\"OTN(含接入OTN）\",\"level\":\"2\",\"parentId\":57,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":59,\"code\":\"SDH&MSTP\",\"name\":\"SDH/MSTP\",\"level\":\"2\",\"parentId\":57,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":60,\"code\":\"WDM&ROADM\",\"name\":\"WDM/ROADM\",\"level\":\"2\",\"parentId\":57,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":61,\"code\":\"sincNet\",\"name\":\"同步网网络\",\"level\":\"2\",\"parentId\":57,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":62,\"code\":\"nativeLine\",\"name\":\"本地网光缆线路\",\"level\":\"2\",\"parentId\":57,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":63,\"code\":\"loneDistanceLine\",\"name\":\"长途光缆线路\",\"level\":\"2\",\"parentId\":57,\"remark\":\"按照知识的专业领域填写\",\"children\":null},{\"id\":308,\"code\":\"hlcs\",\"name\":\"海缆\",\"level\":\"2\",\"parentId\":57,\"remark\":null,\"children\":null}]},{\"id\":65,\"code\":\"emergency\",\"name\":\"应急保障\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":66,\"code\":\"UVC\",\"name\":\"短波\",\"level\":\"2\",\"parentId\":65,\"remark\":null,\"children\":null},{\"id\":67,\"code\":\"VSAT\",\"name\":\"卫星通讯\",\"level\":\"2\",\"parentId\":65,\"remark\":null,\"children\":null},{\"id\":68,\"code\":\"UAV\",\"name\":\"无人机\",\"level\":\"2\",\"parentId\":65,\"remark\":null,\"children\":null}]},{\"id\":69,\"code\":\"cloudBaseDevice\",\"name\":\"云基础设施\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":70,\"code\":\"publicCloud\",\"name\":\"公有云（含天翼云）\",\"level\":\"2\",\"parentId\":69,\"remark\":null,\"children\":null},{\"id\":71,\"code\":\"privateCloud\",\"name\":\"私有云\",\"level\":\"2\",\"parentId\":69,\"remark\":null,\"children\":null},{\"id\":72,\"code\":\"mixCloud\",\"name\":\"混合云\",\"level\":\"2\",\"parentId\":69,\"remark\":null,\"children\":null},{\"id\":73,\"code\":\"exclusiveCloud\",\"name\":\"专属云\",\"level\":\"2\",\"parentId\":69,\"remark\":null,\"children\":null},{\"id\":74,\"code\":\"borderCloud\",\"name\":\"边缘云\",\"level\":\"2\",\"parentId\":69,\"remark\":null,\"children\":null}]},{\"id\":76,\"code\":\"IT\",\"name\":\"IT业务支撑\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":77,\"code\":\"plan\",\"name\":\"IT规划\",\"level\":\"2\",\"parentId\":76,\"remark\":null,\"children\":null},{\"id\":78,\"code\":\"build\",\"name\":\"IT建设\",\"level\":\"2\",\"parentId\":76,\"remark\":null,\"children\":null},{\"id\":79,\"code\":\"devOps\",\"name\":\"运维(含PaaS组件)\",\"level\":\"2\",\"parentId\":76,\"remark\":null,\"children\":null}]},{\"id\":80,\"code\":\"security\",\"name\":\"安全\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":81,\"code\":\"cloudNetSecurity\",\"name\":\"云网运行安全\",\"level\":\"2\",\"parentId\":80,\"remark\":null,\"children\":null},{\"id\":82,\"code\":\"MIMSG\",\"name\":\"网信安全\",\"level\":\"2\",\"parentId\":80,\"remark\":null,\"children\":null},{\"id\":83,\"code\":\"dataSecurity\",\"name\":\"数据安全\",\"level\":\"2\",\"parentId\":80,\"remark\":null,\"children\":null}]},{\"id\":84,\"code\":\"dh\",\"name\":\"动环\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":85,\"code\":\"power\",\"name\":\"各类通信局（站）的电源\",\"level\":\"2\",\"parentId\":84,\"remark\":null,\"children\":null},{\"id\":86,\"code\":\"device\",\"name\":\"机房环境基础设施\",\"level\":\"2\",\"parentId\":84,\"remark\":null,\"children\":null}]},{\"id\":88,\"code\":\"roomManage\",\"name\":\"机房管理\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":89,\"code\":\"communicationRoom\",\"name\":\"通信机房\",\"level\":\"2\",\"parentId\":88,\"remark\":null,\"children\":null},{\"id\":90,\"code\":\"itRoom\",\"name\":\"IT 机房\",\"level\":\"2\",\"parentId\":88,\"remark\":null,\"children\":null},{\"id\":91,\"code\":\"dataCenterRoom\",\"name\":\"数据中心和电源\",\"level\":\"2\",\"parentId\":88,\"remark\":null,\"children\":null},{\"id\":92,\"code\":\"airConditionRoom\",\"name\":\"空调机房\",\"level\":\"2\",\"parentId\":88,\"remark\":null,\"children\":null}]},{\"id\":93,\"code\":\"zhzc\",\"name\":\"综合支撑\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":94,\"code\":\"costManage\",\"name\":\"成本管理\",\"level\":\"2\",\"parentId\":93,\"remark\":null,\"children\":null},{\"id\":95,\"code\":\"rule\",\"name\":\"规章制度\",\"level\":\"2\",\"parentId\":93,\"remark\":null,\"children\":null},{\"id\":96,\"code\":\"person\",\"name\":\"人才队伍\",\"level\":\"2\",\"parentId\":93,\"remark\":null,\"children\":null},{\"id\":97,\"code\":\"asset\",\"name\":\"资产管理\",\"level\":\"2\",\"parentId\":93,\"remark\":null,\"children\":null},{\"id\":342,\"code\":\"ywyygh\",\"name\":\"云网运营规划\",\"level\":\"2\",\"parentId\":93,\"remark\":null,\"children\":null}]},{\"id\":306,\"code\":\"zhjk\",\"name\":\"综合监控\",\"level\":\"1\",\"parentId\":-1,\"remark\":null,\"children\":[{\"id\":359,\"code\":\"zyyyfx\",\"name\":\"运营分析\",\"level\":\"2\",\"parentId\":306,\"remark\":null,\"children\":null}]},{\"id\":309,\"code\":\"khfwzc\",\"name\":\"客户服务支撑\",\"level\":\"1\",\"parentId\":-1,\"remark\":\"客户服务支撑\",\"children\":[{\"id\":310,\"code\":\"cpfan\",\"name\":\"产品方案\",\"level\":\"2\",\"parentId\":309,\"remark\":null,\"children\":null},{\"id\":312,\"code\":\"zckhfw\",\"name\":\"客户服务\",\"level\":\"2\",\"parentId\":309,\"remark\":null,\"children\":null},{\"id\":361,\"code\":\"ywktzhy\",\"name\":\"业务开通\",\"level\":\"2\",\"parentId\":309,\"remark\":\"业务开通-专业领域\",\"children\":null}]}]},{\"type\":\"periodValidity\",\"typeName\":\"有效期\",\"labelTrees\":[{\"id\":55,\"code\":\"1\",\"name\":\"1年\",\"level\":null,\"parentId\":-1,\"remark\":\"\",\"children\":null},{\"id\":56,\"code\":\"3\",\"name\":\"3年\",\"level\":null,\"parentId\":-1,\"remark\":\"\",\"children\":null},{\"id\":57,\"code\":\"5\",\"name\":\"5年\",\"level\":null,\"parentId\":-1,\"remark\":\"\",\"children\":null},{\"id\":58,\"code\":\"-1\",\"name\":\"长期\",\"level\":null,\"parentId\":-1,\"remark\":\"\",\"children\":null},{\"id\":59,\"code\":\"other\",\"name\":\"其他\",\"level\":null,\"parentId\":-1,\"remark\":\"\",\"children\":null}]}]}";

    public void syncInfo3cLabelTree() {
        Info3cTreeResp info3cTreeResp = dataSetServiceClientFeign.info3cTreeList();
//        Info3cTreeResp info3cTreeResp = JSON.parseObject(msg, Info3cTreeResp.class);
        if (info3cTreeResp.getCode() != 200) {
            log.error("3c信息查询异常");
            return;
        }
        List<Info3cTreeParam> data = info3cTreeResp.getData();
        if (!data.isEmpty()) {
            List<Type3cDTO> type3cDTOS = data.stream().map(info3cTreeParam -> {
                Type3cDTO type3cDTO = new Type3cDTO();
                type3cDTO.setType(info3cTreeParam.getType());
                type3cDTO.setTypeName(info3cTreeParam.getTypeName());
                return type3cDTO;
            }).collect(Collectors.toList());
            List<Label3cTreeDTO> label3cTreeDTOS = wrapLabel3cTreeDTO(data);
            type3cServiceClient.deleteAll();
            label3cTreeServiceClientFeign.deleteAll();
            type3cServiceClient.addBatch(type3cDTOS);
            label3cTreeServiceClientFeign.addBatch(label3cTreeDTOS);
        }
    }

    private List<Label3cTreeDTO> wrapLabel3cTreeDTO(List<Info3cTreeParam> data) {
        List<Label3cTreeDTO> label3cTreeDTOS = new ArrayList<>();
        if (CollectionUtil.isEmpty(data)) {
            return label3cTreeDTOS;
        }
        data.forEach(info3cTreeParam -> {
            String type = info3cTreeParam.getType();
            List<Info3cLabelTree> labelTrees = info3cTreeParam.getLabelTrees();

            labelTrees.forEach(labelTree -> traverseAndAdd(labelTree, type, label3cTreeDTOS));
        });
        return label3cTreeDTOS;
    }

    private void traverseAndAdd(Info3cLabelTree node, String type, List<Label3cTreeDTO> result) {
        Label3cTreeDTO dto = new Label3cTreeDTO();
        dto.setId(node.getId().intValue());
        dto.setType(type);
        dto.setCode(node.getCode());
        dto.setName(node.getName());
        dto.setLevel(node.getLevel());
        dto.setParentId(node.getParentId());
        result.add(dto);
        if (!CollectionUtil.isEmpty(node.getChildren())) {
            node.getChildren().forEach(child -> traverseAndAdd(child, type, result));
        }
    }
}
